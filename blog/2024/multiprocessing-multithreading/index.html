<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Multithreading and Multiprocessing in Python | Giovanni Briglia </title> <meta name="author" content="Giovanni Briglia"> <meta name="description" content="When use one respect to other, best practices, possible implementations"> <meta name="keywords" content="causality, reinforcement learning, multi-agent systems, distributed systems"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://giovannibriglia.github.io/blog/2024/multiprocessing-multithreading/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="//"> <span class="font-weight-bold">Giovanni</span> Briglia </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/Blog/index.html">Blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/Publications/">Publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/Repositories/">Repositories </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Multithreading and Multiprocessing in Python</h1> <p class="post-meta"> Created in August 13, 2024 </p> <p class="post-tags"> <a href="//blog/2024"> <i class="fa-solid fa-calendar fa-sm"></i> 2024 </a>   ·   <a href="//blog/tag/concepts"> <i class="fa-solid fa-hashtag fa-sm"></i> concepts</a>   <a href="//blog/tag/code"> <i class="fa-solid fa-hashtag fa-sm"></i> code</a>   ·   <a href="//blog/category/work"> <i class="fa-solid fa-tag fa-sm"></i> work</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p>Python is a programming language not designed for high-performance applications, its benefits come from the ease of learning and usability. Even though there are several arrangements you can employ to speed up your applications.</p> <p>In this blog post, I would like to show you what I have learnt regarding this topic and provide you some code and reference that could be useful.</p> <p>First of all, <em>functional programming</em> is the most valuable aspect to take into account before applying whatever multiprocessing-multithreading techniques. Here, what I think are interesting resources to consider are provided:</p> <ul> <li><a href="https://refactoring.com/" rel="external nofollow noopener" target="_blank">Refactoring Book</a></li> <li><a href="https://blog.cleancoder.com/" rel="external nofollow noopener" target="_blank">The Clean Coder’s Blog</a></li> <li><a href="https://docs.python.org/3/howto/functional.html" rel="external nofollow noopener" target="_blank">Python documentation</a></li> <li><a href="https://realpython.com/python-functional-programming/" rel="external nofollow noopener" target="_blank">RealPython Functional Programming</a></li> </ul> <p>Once you have assessed your program by exploiting the function programming best practices, you can start on reasoning about which task can be computed in parallel and which ones are slower in the code.</p> <p>It is worth noticing that, if your code follows in the right way the function programming best practices, introducing parallel computation parts will be straightforward.</p> <p>Before describing what are the differences between multithreading and multiprocessing and how to choose one respect to other, let us introduce some basic concepts, to provide some background knowledge.</p> <h4 id="thread-vs-process">Thread vs. Process</h4> <p>First of all, the thread is part of the process; moreover, a process can consist of multiple threads.</p> <h3 id="definitions">Definitions</h3> <ul> <li> <p><em>Process</em>: a process is an independent program in execution. It contains the program code, its current activity, and its allocated system resources, like memory and CPU time.</p> </li> <li> <p><em>Thread</em>: a thread is the smallest unit of execution within a process. Multiple threads can exist within the same process, sharing the same memory space but able to execute independently.</p> </li> </ul> <h3 id="memory-usage">Memory usage</h3> <ul> <li> <p><em>Process</em>: each process operates in its own memory space; the memory allocated to a process is isolated from other processes, which provides stability and security since one process cannot directly interfere with the memory of another process.</p> </li> <li> <p><em>Thread</em>: threads with the same process share the same memory space. This allows them to access the same data more efficiently, but also introduces risks of conflicts if multiple threads try to modify the same data simultaneously.</p> </li> </ul> <h3 id="communication">Communication</h3> <ul> <li> <p><em>Process</em>: processes generally communicate with each other through inter-process communication (IPC) mechanisms like pipes, message queues, or shared memory, which can be relatively slow and complex to implement.</p> </li> <li> <p><em>Thread</em>: since threads within the same process share the same memory, they can communicate directly by reading and writing to shared variables. This communication is faster and simpler than IPC between processes.</p> </li> </ul> <h3 id="overhead">Overhead</h3> <ul> <li> <p><em>Process</em>: processes have a higher overhead compared to threads because creating, managing and switching between processes requires more resources. The operating system needs to maintain separate memory and resources for each process.</p> </li> <li> <p><em>Thread</em>: threads have a lower overhead compared to processes. Creating and switching between threads within the same process is faster and requires fewer resources since they have the same memory space.</p> </li> </ul> <h3 id="use-case">Use Case</h3> <ul> <li> <p><em>Process</em>: processes are typically used when tasks need to be isolated from each other, such as running different applications on a computer.</p> </li> <li> <p><em>Thread</em>: threads are commonly used in situations where tasks are closely related and need to share data quickly and efficiently, such as in a web server handling multiple client requests concurrently.</p> </li> </ul> <h3 id="summary">Summary</h3> <ul> <li> <strong>Isolation</strong>: processes are isolated from each other, while threads within the same process are not</li> <li> <strong>Resource Sharing</strong>: threads share resources of the process they belong to, including memory and open files, while processes do not share their resources by default.</li> <li> <strong>Creation and Context Switching</strong>: creating and switching between processes is more resource-intensive than creating and switching between threads.</li> </ul> <p>Useful links:</p> <ul> <li><a href="https://medium.com/capital-one-tech/python-guide-using-multiprocessing-versus-multithreading-55c4ea1788cd" rel="external nofollow noopener" target="_blank">Mario</a></li> <li><a href="https://www.geeksforgeeks.org/difference-between-multithreading-vs-multiprocessing-in-python/" rel="external nofollow noopener" target="_blank">Mario</a></li> </ul> <h4 id="multi-threading-vs-multi-processing">Multi-threading vs. Multi-processing</h4> <p>Multi-threading and multi-processing are both techniques used to achieve parallelism and improve the performance of a program by dividing tasks into smaller, concurrent units of execution. However, they differ in how they manage these units and use system resources.</p> <h3 id="definitions-1">Definitions</h3> <ul> <li> <p><em>Multi-processing</em>: multi-processing involves running multiple processes simultaneously, each with its own independent memory space. These processes can run on separate CPU cores and do not share memory, which eliminates the need for synchronization but increases memory usage.</p> </li> <li> <p><em>Multi-threading</em>: multi-threading involves threads within a single process sharing memory, leading to potential synchronization issues, while multi-processing uses separate memory spaces for each process, avoiding these issues but at the cost of higher memory usage and communication complexity.</p> </li> </ul> <h3 id="memory-usage-1">Memory usage</h3> <ul> <li> <p><em>Multi-processing</em>: each process in a multi-processing environment has its own memory space, so processes do not share data directly. This isolation can be beneficial for preventing conflicts but can lead to higher memory consumption since each process must maintain its own memory.</p> </li> <li> <p><em>Multi-threading</em>: since all threads within a multi-threaded application share the same memory space, they can easily access and modify shared data. However, this also means that multi-threading can lead to issues such as race conditions, where multiple threads try to modify the same data simultaneously, leading to inconsistent results.</p> </li> </ul> <h3 id="communication-1">Communication</h3> <ul> <li> <p><em>Multi-processing</em>: processes in a multi-processing setup typically communicate using IPC mechanisms. While secure and isolated, this communication is generally slower and more complex compared to the shared memory approach used in multi-threading.</p> </li> <li> <p><em>Multi-threading</em>: threads in a multi-threading program communicate by accessing shared memory. This is efficient, but requires careful synchronization (e.g., using mutexes or locks) to avoid conflicts and ensure data integrity.</p> </li> </ul> <h3 id="overhead-1">Overhead</h3> <ul> <li> <p><em>Multi-processing</em>: multi-processing has higher overhead than multi-threading because creating and managing separate processes requires more resources, including memory and CPU time for context switching between processes.</p> </li> <li> <p><em>Multi-threading</em>: multi-threading generally has lower overhead compared to multi-processing because threads share resources and the operating system does not need to create a separate memory space for each thread. However, the need for synchronization mechanisms can introduce some complexity and performance penalties.</p> </li> </ul> <h3 id="use-case-1">Use case</h3> <ul> <li> <p><em>Multi-processing</em>: multi-processing is ideal for tasks that require significant CPU computation and benefit from running in parallel without sharing memory, such as data processing, simulations, or applications that need to fully use multiple cores without worrying about synchronization issues</p> </li> <li> <p><em>Multi-threading</em>: multi-threading is well-suited for applications that require concurrent execution of tasks that share data or resources, such as a web server that handles multiple requests simultaneously.</p> </li> </ul> <h3 id="performance">Performance</h3> <ul> <li> <p><em>Multi-processing</em>: multi-processing can achieve true parallelism, even in languages with a GIL (like Python), because each process runs in its own memory space. This made it suitable for CPU-bound tasks that require heavy computation across multiple cores.</p> </li> <li> <p><em>Multi-threading</em>: multi-threading can provide significant performance improvements, especially on multi-core processors, but it is limited by the Global Interpreter Lock (GIL) in some languages like Python, which can prevent true parallel execution of threads.</p> </li> </ul> <h3 id="summary-1">Summary</h3> <ul> <li> <em>Memory sharing</em>: multi-threading involves threads within a single process sharing memory, leading to potential synchronization issues, while multi-processing uses separate memory spaces for each process, avoiding these issues but at the cost of higher memory usage and communication complexity.</li> <li> <em>Communication</em>: multi-threading uses shared memory for fast communication, while multi-processing relies on slower IPC mechanisms.</li> <li> <em>Overhead</em>: multi-threading has lower overhead in terms of memory and context switching, while multi-processing has higher overhead due to the need to manage separate processes.</li> <li> <em>Parallelism</em>: multi-processing can achieve true parallelism even in environments with limitations like the GIL, while multi-threading may be limited by such factors.</li> <li> <em>Overall</em>: multi-threading is typically used for tasks that require concurrent execution with shared resources, while multi-processing is preferred for tasks that benefit from true parallelism and isolation.</li> </ul> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="//blog/2024/planning-under-uncertainty-pearl/">Judea Pearl on planning under uncertainty</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="//blog/2024/causal-inference-pgmpy/">Implement Causal Inference with pgmpy</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="//blog/2024/resume-and-phd-announcement/">Career Update</a> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Giovanni Briglia. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> <script type="module" src="/assets/js/search/ninja-keys.min.js?601a2d3465e2a52bec38b600518d5f70"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script>let searchTheme=determineComputedTheme();const ninjaKeys=document.querySelector("ninja-keys");"dark"===searchTheme?ninjaKeys.classList.add("dark"):ninjaKeys.classList.remove("dark");const openSearchModal=()=>{const e=$("#navbarNav");e.hasClass("show")&&e.collapse("hide"),ninjaKeys.open()};</script> <script>const ninja=document.querySelector("ninja-keys");ninja.data=[{id:"nav-about",title:"About",section:"Navigation",handler:()=>{window.location.href="/"}},{id:"nav-blog",title:"Blog",description:"",section:"Navigation",handler:()=>{window.location.href="/Blog/index.html"}},{id:"nav-publications",title:"Publications",description:"Publications by categories in reversed chronological order.",section:"Navigation",handler:()=>{window.location.href="/Publications/"}},{id:"nav-projects",title:"Projects",description:"A growing collection of your cool projects.",section:"Navigation",handler:()=>{window.location.href="/projects/"}},{id:"nav-repositories",title:"Repositories",description:"",section:"Navigation",handler:()=>{window.location.href="/Repositories/"}},{id:"post-judea-pearl-on-planning-under-uncertainty",title:"Judea Pearl on planning under uncertainty",description:"A probabilistic calculus of actions",section:"Posts",handler:()=>{window.location.href="/blog/2024/planning-under-uncertainty-pearl/"}},{id:"post-multithreading-and-multiprocessing-in-python",title:"Multithreading and Multiprocessing in Python",description:"When use one respect to other, best practices, possible implementations",section:"Posts",handler:()=>{window.location.href="/blog/2024/multiprocessing-multithreading/"}},{id:"post-implement-causal-inference-with-pgmpy",title:"Implement Causal Inference with pgmpy",description:"How to employ correctly causal inference in Python, what is causal inference and why you need it",section:"Posts",handler:()=>{window.location.href="/blog/2024/causal-inference-pgmpy/"}},{id:"post-career-update",title:"Career Update",description:"What is happened so far and PhD announcement",section:"Posts",handler:()=>{window.location.href="/blog/2024/resume-and-phd-announcement/"}},{id:"news-site-online",title:"Site online!!",description:"",section:"News"},{id:"projects-project-1",title:"project 1",description:"with background image",section:"Projects",handler:()=>{window.location.href="/projects/1_project/"}},{id:"socials-email",title:"Send email",section:"Socials",handler:()=>{window.open("mailto:%67%69%6F%76%61%6E%6E%69.%62%72%69%67%6C%69%61@%75%6E%69%6D%6F%72%65.%69%74","_blank")}},{id:"socials-orcid",title:"ORCID",section:"Socials",handler:()=>{window.open("https://orcid.org/0000-0002-9572-3150","_blank")}},{id:"socials-google-scholar",title:"Google Scholar",section:"Socials",handler:()=>{window.open("https://scholar.google.com/citations?user=p9e44eoAAAAJ","_blank")}},{id:"socials-github",title:"GitHub",section:"Socials",handler:()=>{window.open("https://github.com/Giovannibriglia","_blank")}},{id:"socials-linkedin",title:"LinkedIn",section:"Socials",handler:()=>{window.open("https://www.linkedin.com/in/giovanni-briglia-929a20200","_blank")}},{id:"socials-rss",title:"RSS Feed",section:"Socials",handler:()=>{window.open("//feed.xml","_blank")}},{id:"light-theme",title:"Change theme to light",description:"Change the theme of the site to Light",section:"Theme",handler:()=>{setThemeSetting("light")}},{id:"dark-theme",title:"Change theme to dark",description:"Change the theme of the site to Dark",section:"Theme",handler:()=>{setThemeSetting("dark")}},{id:"system-theme",title:"Use system default theme",description:"Change the theme of the site to System Default",section:"Theme",handler:()=>{setThemeSetting("system")}}];</script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>